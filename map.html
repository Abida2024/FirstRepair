<!DOCTYPE html>
<html>
    <title> Reparations Legislation </title>
    <head>
        <!-- Plotly.js -->
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    </head>
    <p>
        The following map was created using plotly.js, please feel free to play around with other styles!
        <a href="https://bit.ly/1Or9igj">plotly.js documentation</a>
    </p>
    <!-- Create an empty div in which to draw the graph "-->
    <div id="mapFP" style="width:200%;height:750px">
    </div>
</html>

<script type = "module"> 
    import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";
    var data = [{
        type: 'scattergeo',
        mode: 'markers+text',
        text: [
            'Evanston', 'Chicago', 
        ],
        lon: [
            -87.68, -87.62 
        ],
        lat: [
            42.05, 41.88
        ],
        marker: {
            size: 7,
            color: [
                '#0ff', '#0ff'
            ],
            line: {
                width: 1
            }
        },
        name: 'Map of US Cities that have passed legislative actions wrt reparations',
        textposition: [
            'top right', 'bottom right'
        ],
    }];

    let lat = [];
    let lon = [];
    let text = [];
    let color = [];
    let textposition = [];
    d3.csv('datapoints.csv').then((data2) => {
        // Iterate through each of the rows in the csv file
        // Append to data latitude and longitude  
        data2.map((d) => {
            d['Latitude'] === '' ? "" : lat.push(+d['Latitude']);
            d['Longitude'] === '' ? "": lon.push(-1*+d['Longitude']);
            d['Latitude'] === '' ? "" : text.push(d['State ']);
            d['Latitude'] === '' ? "" : color.push('#0ff');
            d['Latitude'] === '' ? "" : textposition.push('top right');});
    });

    data[0].lat = lat; 
    data[0].lon = lon; 
    data[0].text = text;
    data[0].marker.color = color;
    data[0].textposition = textposition;
    console.log(data); 

    var layout = {
        title: 'Map of US Cities',
        font: {
            family: 'Droid Serif, serif',
            size: 6
        },
        titlefont: {
            size: 16
        },
        geo: {
            scope: 'north america',
            resolution: 50,
            lonaxis: {
                'range': [-130, -55]
            },
            lataxis: {
                'range': [40, 70]
            },
            showrivers: false,
            showlakes: true,
            lakecolor: '#fff',
            showland: true,
            landcolor: '#fff',
            countrycolor: '#d3d3d3',
            countrywidth: 1.5,
            subunitcolor: '#d3d3d3'
        }
    };
    Plotly.newPlot('mapFP', data, layout);

</script>

