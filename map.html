<!DOCTYPE html>
<html>
    <title> Reparations Legislation </title>
    <head>
        <!-- Plotly.js -->
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    </head>
    <p style="position:relative; left:1000px; top:20px;"">
        
        The following map was created to depict legislative actions involving reparations across the United States. <br> Feel free to click a state to learn more about related bills that have been proposed/passed.
        <a href="https://github.com/Abida2024/FirstRepair">Check out our code if you are interested!</a>
    
    </p>
    <!-- Create an empty div in which to draw the graph "-->
    <div id="mapFP" style="width:200%;height:750px">
    </div>
</html>

<script type = "module"> 
    import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";
    var data = [{
        type: 'scattergeo',
        mode: 'markers+text',
        text: [
            'Evanston', 
        ],
        lon: [
            -87.68,
        ],
        lat: [
            42.05,
        ],
        marker: {
            size: 7,
            color: [
                '#0ff',
            ],
            line: {
                width: 1,
            }
        },
        name: 'Map of US Cities that have passed legislative actions wrt reparations',
        textposition: [
            'top right',
        ],
    }];

    d3.csv("datapoints.csv").then((data2) => {
        // Iterate through each of the rows in the csv file
        // Append to data latitude and longitude  
        data2.map((d) =>{
            d['Latitude'] === '' ? "" : data[0].lat.push(+d['Latitude']);
            d['Longitude'] === '' ? "": data[0].lon.push(-1*+d['Longitude']);
            d['Latitude'] === '' ? "": data[0].text.push(d['State ']);
            d['Latitude'] === '' ? "": data[0].marker.color.push('#0ff');
            d['Latitude'] === '' ? "": data[0].textposition.push('top right')});
        console.log(data);
        Plotly.newPlot('mapFP', data, layout);
    });

    //d3.csv()


    console.log(data); 
    console.log(data); 
    
    var layout = {
        title: 'Map of US Cities',
        font: {
            family: 'Droid Serif, serif',
            size: 6
        },
        titlefont: {
            size: 16
        },
        geo: {
            scope: 'north america',
            resolution: 50,
            lonaxis: {
                'range': [-130, -55]
            },
            lataxis: {
                'range': [40, 70]
            },
            showrivers: false,
            showlakes: true,
            lakecolor: '#fff',
            showland: true,
            landcolor: '#fff',
            countrycolor: '#d3d3d3',
            countrywidth: 1.5,
            subunitcolor: '#d3d3d3'
        }
    };

    //Plotly.newPlot('mapFP', data, layout);
    console.log(data);

</script>

